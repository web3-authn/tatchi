# Relay Server (Node)

Create accounts, handle WebAuthn registration, and run Shamir 3‑pass endpoints. Use the example server or wire the SDK’s server helpers into your framework.

## Quick start (example)

```bash
cd examples/relay-server
cp env.example .env
pnpm install
pnpm dev
```

Key env:

```bash
RELAYER_ACCOUNT_ID=relayer.testnet
RELAYER_PRIVATE_KEY=ed25519:...
NEAR_NETWORK_ID=testnet
NEAR_RPC_URL=https://rpc.testnet.near.org
WEBAUTHN_CONTRACT_ID=w3a-v1.testnet
EXPECTED_ORIGIN=https://example.localhost
EXPECTED_WALLET_ORIGIN=https://wallet.example.localhost

# Shamir 3‑pass
SHAMIR_P_B64U=...
SHAMIR_E_S_B64U=...
SHAMIR_D_S_B64U=...
```

## Use in your server

```ts
import express from 'express'
import { NearAccountService, getServerConfig } from '@tatchi/sdk/server'

const app = express()
const svc = new NearAccountService(getServerConfig())

app.post('/create_account_and_register_user', async (req, res) => {
  res.json(await svc.createAccountAndRegisterUser(await req.body))
})
```

## Shamir 3‑pass endpoints

- `POST /vrf/apply-server-lock` → `{ kek_cs_b64u, keyId }`
- `POST /vrf/remove-server-lock` → `{ kek_c_b64u }` (requires `keyId`)
- `GET /shamir/key-info` → `{ currentKeyId, p_b64u, graceKeyIds }`

See also:
- examples/relay-server/README.md
- sdk/src/server/README.md
