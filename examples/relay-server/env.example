RELAYER_ACCOUNT_ID=w3a-relayer.testnet
RELAYER_PRIVATE_KEY=ed25519:

# Web3Authn contract account ID used for verification calls
WEBAUTHN_CONTRACT_ID=w3a-v1.testnet

# Optional override (defaults to https://test.rpc.fastnear.com in this example)
# NEAR_RPC_URL=https://rpc.testnet.near.org

# pnpm gen:shamir
# Shamir is optional; if you set any SHAMIR_* var, you must set all 3.
SHAMIR_P_B64U=3N5w46AIGjGT2v5Vua_TMD5Ywfa9U2F7-WzW8SNDsIM # public P
SHAMIR_E_S_B64U=
SHAMIR_D_S_B64U=

EXPECTED_ORIGIN=https://example.localhost
EXPECTED_WALLET_ORIGIN=https://wallet.example.localhost

# Session (optional; enables JWT + HttpOnly cookie)
JWT_SECRET=change-me
JWT_ISSUER=relay-server
JWT_AUDIENCE=tatchi-app
JWT_EXPIRES_SEC=86400
SESSION_COOKIE_NAME=w3a_session
SESSION_SAME_SITE=Lax

# Threshold Ed25519 (2p FROST) signing (optional)
# Share mode:
# - auto (default): derive relayer share if master secret is set, else use persisted share
# - derived: always derive relayer share (stateless relayer; recommended for clusters/serverless)
# - kv: always use persisted relayer share (requires Redis/Upstash or in-memory dev-only)
THRESHOLD_ED25519_SHARE_MODE=derived
# Required for share mode "derived" (32 bytes, base64url).
# node -e "console.log(require('crypto').randomBytes(32).toString('base64url'))"
THRESHOLD_ED25519_MASTER_SECRET_B64U=

# Coordinator/cosigner wiring (optional; used when running a multi-process relay fleet).
# - coordinator exposes /threshold-ed25519/sign/*
# - cosigners expose /threshold-ed25519/internal/cosign/*
THRESHOLD_NODE_ROLE=coordinator
# Required for THRESHOLD_NODE_ROLE=cosigner.
# Each relayer process must have its own unique cosigner id (u16).
# THRESHOLD_ED25519_RELAYER_COSIGNER_ID=1
# Coordinator <-> cosigner shared secret for internal grants (32 bytes, base64url).
# node -e "console.log(require('crypto').randomBytes(32).toString('base64url'))"
THRESHOLD_COORDINATOR_SHARED_SECRET_B64U=

# Relayer-fleet internal t-of-n cosigning (external signer set stays 2P: client + logical relayer).
# For local dev fleet mode, cosigner URLs are usually direct localhost HTTP (no TLS).
# THRESHOLD_ED25519_RELAYER_COSIGNERS='[{"cosignerId":1,"relayerUrl":"http://127.0.0.1:3000"},{"cosignerId":2,"relayerUrl":"http://127.0.0.1:3001"},{"cosignerId":3,"relayerUrl":"http://127.0.0.1:3002"}]'
# THRESHOLD_ED25519_RELAYER_COSIGNER_T=2

# Optional persistence for threshold sessions (recommended for production).
# If omitted, the relayer uses in-memory stores (NOT safe across restarts/instances).
# Upstash REST (Cloudflare-friendly)
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=
# Redis TCP (Node-only)
# REDIS_URL=redis://localhost:6379

# Optional zk-email prover (used when explicitMode='zk-email' or email body marker is 'zk-email')
# Local docker default: http://127.0.0.1:5588
# ZK_EMAIL_PROVER_BASE_URL=http://127.0.0.1:5588
# ZK_EMAIL_PROVER_TIMEOUT_MS=60000

# Optional: Grace keys accepted for remove-server-lock during rotation.
# Provide a path to a JSON file containing an array of { e_s_b64u, d_s_b64u } pairs.
# SHAMIR_GRACE_KEYS_FILE=./grace-keys.json

# Key rotation interval (in minutes)
ROTATE_EVERY=60
