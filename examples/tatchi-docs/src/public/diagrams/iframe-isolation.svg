<svg xmlns="http://www.w3.org/2000/svg" width="720" height="380" viewBox="0 0 720 380" role="img" aria-labelledby="title desc">
  <title id="title">Tatchi wallet iframe isolation</title>
  <desc id="desc">
    Your App hosts a wallet iframe and communicates with it over a bidirectional MessageChannel. Inside the iframe, a WASM worker performs crypto operations and talks to WebAuthn.
  </desc>

  <defs>
    <style>
      text {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        fill: #111827;
      }
      .label {
        font-size: 14px;
        font-weight: 600;
      }
      .subLabel {
        font-size: 12px;
      }
      .app-box {
        fill: #f3f4f6;
        stroke: #9ca3af;
        stroke-width: 1.5;
        rx: 8;
        ry: 8;
      }
      .iframe-box {
        fill: #ffffff;
        stroke: #9ca3af;
        stroke-width: 1.4;
        rx: 6;
        ry: 6;
      }
      .inner-box {
        fill: #ffffff;
        stroke: #9ca3af;
        stroke-width: 1.2;
        rx: 5;
        ry: 5;
      }
      .arrow {
        stroke: #4b5563;
        stroke-width: 1.7;
        fill: none;
        marker-start: url(#arrowhead);
        marker-end: url(#arrowhead);
      }
    </style>

    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto" markerUnits="strokeWidth">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#4b5563" />
    </marker>
  </defs>

  <!-- Your App container -->
  <rect class="app-box" x="20" y="20" width="680" height="340" />
  <text class="label" x="50" y="50">
    Your App (app.example.com)
  </text>

  <!-- Wallet iframe box inside the app -->
  <rect class="iframe-box" x="60" y="100" width="600" height="240" />
  <text class="label" x="360" y="130" text-anchor="middle">
    Wallet Iframe (wallet.example.com)
  </text>

  <!-- MessageChannel arrow between app and iframe -->
  <line class="arrow" x1="360" y1="60" x2="360" y2="100" />
  <text class="subLabel" x="380" y="83">
    MessageChannel
  </text>

  <!-- WASM worker box -->
  <rect class="inner-box" x="100" y="180" width="230" height="120" />
  <text class="label" x="215" y="210" text-anchor="middle">
    WASM Worker
  </text>
  <text class="subLabel" x="215" y="234" text-anchor="middle">
    Crypto operations
  </text>

  <!-- WebAuthn box -->
  <rect class="inner-box" x="390" y="180" width="230" height="120" />
  <text class="label" x="505" y="210" text-anchor="middle">
    WebAuthn
  </text>
  <text class="subLabel" x="505" y="234" text-anchor="middle">
    Operations
  </text>

  <!-- Arrow between WASM worker and WebAuthn -->
  <line class="arrow" x1="330" y1="240" x2="390" y2="240" />
</svg>

